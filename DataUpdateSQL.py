import pandas as pd
import sqlalchemy
from sqlalchemy import create_engine
import pyodbc
import urllib

con = pyodbc.connect('Driver={SQL Server};'
                    'Server=TITANIUM-BOOK;'
                    'Database=DataDashboard;'
                    'Trusted_Connection=yes;',
                    autocommit=True)
c = con.cursor()

def endProgram():
    exit()
    while True:
        endProgram()

try:
    #Publish to Database
    def SQL(): #working
        source = int(input('-------------------------\nWhat folder are you publishing? '))
        if source == 0:
            print('\nMenu:\n1-Demographics\n2-Earnings\n3-Health\n4-Labor\n5-Land\n6-Natural Products\n\n999-Exit\n')
            SQL()
        elif source == 1: #Demographics
            print('Publishing Demographics')
            table = int(input('What table are you publishing? '))
            if table == 0:
                print('\nDemographics Sources:\n1-Civilian Labor Force\n2-EQFXSUBPRIME\n3-People 25 and Over Education\n4-Resident Population')
            elif table == 1:
                print('Publishing Civilian Labor Force')
                df = pd.read_csv('./Updates/STG_FRED_Civilian_Labor_Force_by_County_Persons.txt')
                df = df.reset_index()
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_FRED_Civilian_Labor_Force_by_County_Persons_BACKUP')
                c.execute('''sp_rename 'dbo.STG_FRED_Civilian_Labor_Force_by_County_Persons','STG_FRED_Civilian_Labor_Force_by_County_Persons_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_FRED_Civilian_Labor_Force_by_County_Persons](
                    [Series ID] [varchar](14) NULL,
                    [Region Name] [varchar](23) NULL,
                    [Region Code] [int] NULL,
                    [1975] [float] NULL,
                    [1976] [float] NULL,
                    [1977] [float] NULL,
                    [1978] [float] NULL,
                    [1979] [float] NULL,
                    [1980] [float] NULL,
                    [1981] [float] NULL,
                    [1982] [float] NULL,
                    [1983] [float] NULL,
                    [1984] [float] NULL,
                    [1985] [float] NULL,
                    [1986] [float] NULL,
                    [1987] [float] NULL,
                    [1988] [float] NULL,
                    [1989] [float] NULL,
                    [1990] [float] NULL,
                    [1991] [float] NULL,
                    [1992] [float] NULL,
                    [1993] [float] NULL,
                    [1994] [float] NULL,
                    [1995] [float] NULL,
                    [1996] [float] NULL,
                    [1997] [float] NULL,
                    [1998] [float] NULL,
                    [1999] [float] NULL,
                    [2000] [float] NULL,
                    [2001] [float] NULL,
                    [2002] [float] NULL,
                    [2003] [float] NULL,
                    [2004] [float] NULL,
                    [2005] [float] NULL,
                    [2006] [float] NULL,
                    [2007] [float] NULL,
                    [2008] [float] NULL,
                    [2009] [float] NULL,
                    [2010] [float] NULL,
                    [2011] [float] NULL,
                    [2012] [float] NULL,
                    [2013] [float] NULL,
                    [2014] [float] NULL,
                    [2015] [float] NULL,
                    [2016] [float] NULL,
                    [2017] [float] NULL,
                    [2018] [float] NULL,
                    [2019] [float] NULL,
                    [2020] [float] NULL,
                    [2021] [float] NULL,
                    [2022] [float] NULL,
                    [2023] [float] NULL,
                    [2024] [float] NULL,
                    [2025] [float] NULL,
                    [2026] [float] NULL,
                    [2027] [float] NULL,
                    [2028] [float] NULL,
                    [2029] [float] NULL,
                    [2030] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};' 
                                                    r'Server=TITANIUM-BOOK;'
                                                    r'Database=DataDashboard;'
                                                    r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_FRED_Civilian_Labor_Force_by_County_Persons', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif table == 2:
                print('Publishing EQFXSUBPRIME')
                df = pd.read_csv('./Updates/STG_FRED_EQFXSUBPRIME.txt')
                df = df.reset_index()
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                #c.execute('drop table STG_FRED_EQFXSUBPRIME_BACKUP')
                #c.execute('''sp_rename 'dbo.STG_FRED_EQFXSUBPRIME','STG_FRED_EQFXSUBPRIME_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_FRED_EQFXSUBPRIME](
                    [Series ID] [varchar](18) NULL,
                    [Region Name] [varchar](23) NULL,
                    [Region Code] [int] NULL,
                    [1999 Q1] [float] NULL,
                    [1999 Q2] [float] NULL,
                    [1999 Q3] [float] NULL,
                    [1999 Q4] [float] NULL,
                    [2000 Q1] [float] NULL,
                    [2000 Q2] [float] NULL,
                    [2000 Q3] [float] NULL,
                    [2000 Q4] [float] NULL,
                    [2001 Q1] [float] NULL,
                    [2001 Q2] [float] NULL,
                    [2001 Q3] [float] NULL,
                    [2001 Q4] [float] NULL,
                    [2002 Q1] [float] NULL,
                    [2002 Q2] [float] NULL,
                    [2002 Q3] [float] NULL,
                    [2002 Q4] [float] NULL,
                    [2003 Q1] [float] NULL,
                    [2003 Q2] [float] NULL,
                    [2003 Q3] [float] NULL,
                    [2003 Q4] [float] NULL,
                    [2004 Q1] [float] NULL,
                    [2004 Q2] [float] NULL,
                    [2004 Q3] [float] NULL,
                    [2004 Q4] [float] NULL,
                    [2005 Q1] [float] NULL,
                    [2005 Q2] [float] NULL,
                    [2005 Q3] [float] NULL,
                    [2005 Q4] [float] NULL,
                    [2006 Q1] [float] NULL,
                    [2006 Q2] [float] NULL,
                    [2006 Q3] [float] NULL,
                    [2006 Q4] [float] NULL,
                    [2007 Q1] [float] NULL,
                    [2007 Q2] [float] NULL,
                    [2007 Q3] [float] NULL,
                    [2007 Q4] [float] NULL,
                    [2008 Q1] [float] NULL,
                    [2008 Q2] [float] NULL,
                    [2008 Q3] [float] NULL,
                    [2008 Q4] [float] NULL,
                    [2009 Q1] [float] NULL,
                    [2009 Q2] [float] NULL,
                    [2009 Q3] [float] NULL,
                    [2009 Q4] [float] NULL,
                    [2010 Q1] [float] NULL,
                    [2010 Q2] [float] NULL,
                    [2010 Q3] [float] NULL,
                    [2010 Q4] [float] NULL,
                    [2011 Q1] [float] NULL,
                    [2011 Q2] [float] NULL,
                    [2011 Q3] [float] NULL,
                    [2011 Q4] [float] NULL,
                    [2012 Q1] [float] NULL,
                    [2012 Q2] [float] NULL,
                    [2012 Q3] [float] NULL,
                    [2012 Q4] [float] NULL,
                    [2013 Q1] [float] NULL,
                    [2013 Q2] [float] NULL,
                    [2013 Q3] [float] NULL,
                    [2013 Q4] [float] NULL,
                    [2014 Q1] [float] NULL,
                    [2014 Q2] [float] NULL,
                    [2014 Q3] [float] NULL,
                    [2014 Q4] [float] NULL,
                    [2015 Q1] [float] NULL,
                    [2015 Q2] [float] NULL,
                    [2015 Q3] [float] NULL,
                    [2015 Q4] [float] NULL,
                    [2016 Q1] [float] NULL,
                    [2016 Q2] [float] NULL,
                    [2016 Q3] [float] NULL,
                    [2016 Q4] [float] NULL,
                    [2017 Q1] [float] NULL,
                    [2017 Q2] [float] NULL,
                    [2017 Q3] [float] NULL,
                    [2017 Q4] [float] NULL,
                    [2018 Q1] [float] NULL,
                    [2018 Q2] [float] NULL,
                    [2018 Q3] [float] NULL,
                    [2018 Q4] [float] NULL,
                    [2019 Q1] [float] NULL,
                    [2019 Q2] [float] NULL,
                    [2019 Q3] [float] NULL,
                    [2019 Q4] [float] NULL,
                    [2020 Q1] [float] NULL,
                    [2020 Q2] [float] NULL,
                    [2020 Q3] [float] NULL,
                    [2020 Q4] [float] NULL,
                    [2021 Q1] [float] NULL,
                    [2021 Q2] [float] NULL,
                    [2021 Q3] [float] NULL,
                    [2021 Q4] [float] NULL,
                    [2022 Q1] [float] NULL,
                    [2022 Q2] [float] NULL,
                    [2022 Q3] [float] NULL,
                    [2022 Q4] [float] NULL,
                    [2023 Q1] [float] NULL,
                    [2023 Q2] [float] NULL,
                    [2023 Q3] [float] NULL,
                    [2023 Q4] [float] NULL,
                    [2024 Q1] [float] NULL,
                    [2024 Q2] [float] NULL,
                    [2024 Q3] [float] NULL,
                    [2024 Q4] [float] NULL,
                    [2025 Q1] [float] NULL,
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};' 
                                                    r'Server=TITANIUM-BOOK;'
                                                    r'Database=DataDashboard;'
                                                    r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params, pool_pre_ping=True)
                df.to_sql('STG_FRED_EQFXSUBPRIME', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif table == 3:
                print('Publishing People 25 and Over Education')
                df = pd.read_csv('./Updates/STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent.txt')
                df = df.reset_index()
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent_BACKUP')
                c.execute('''sp_rename 'dbo.STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent','STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent](
                    [Series ID] [varchar](14) NULL,
                    [Region Name] [varchar](23) NULL,
                    [Region Code] [int] NULL,
                    [1975] [float] NULL,
                    [1976] [float] NULL,
                    [1977] [float] NULL,
                    [1978] [float] NULL,
                    [1979] [float] NULL,
                    [1980] [float] NULL,
                    [1981] [float] NULL,
                    [1982] [float] NULL,
                    [1983] [float] NULL,
                    [1984] [float] NULL,
                    [1985] [float] NULL,
                    [1986] [float] NULL,
                    [1987] [float] NULL,
                    [1988] [float] NULL,
                    [1989] [float] NULL,
                    [1990] [float] NULL,
                    [1991] [float] NULL,
                    [1992] [float] NULL,
                    [1993] [float] NULL,
                    [1994] [float] NULL,
                    [1995] [float] NULL,
                    [1996] [float] NULL,
                    [1997] [float] NULL,
                    [1998] [float] NULL,
                    [1999] [float] NULL,
                    [2000] [float] NULL,
                    [2001] [float] NULL,
                    [2002] [float] NULL,
                    [2003] [float] NULL,
                    [2004] [float] NULL,
                    [2005] [float] NULL,
                    [2006] [float] NULL,
                    [2007] [float] NULL,
                    [2008] [float] NULL,
                    [2009] [float] NULL,
                    [2010] [float] NULL,
                    [2011] [float] NULL,
                    [2012] [float] NULL,
                    [2013] [float] NULL,
                    [2014] [float] NULL,
                    [2015] [float] NULL,
                    [2016] [float] NULL,
                    [2017] [float] NULL,
                    [2018] [float] NULL,
                    [2019] [float] NULL,
                    [2020] [float] NULL,
                    [2021] [float] NULL,
                    [2022] [float] NULL,
                    [2023] [float] NULL,
                    [2024] [float] NULL,
                    [2025] [float] NULL,
                    [2026] [float] NULL,
                    [2027] [float] NULL,
                    [2028] [float] NULL,
                    [2029] [float] NULL,
                    [2030] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};' 
                                                    r'Server=TITANIUM-BOOK;'
                                                    r'Database=DataDashboard;'
                                                    r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_FRED_People_25_Years_and_Over_Who_Have_Completed_an_Associates_Degree_or_Higher_5year_estimate_by_County_Percent', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif table == 4:
                print('Publishing Resident Population')
                df = pd.read_csv('./Updates/STG_FRED_Resident_Population_by_County_Thousands_of_Persons.txt')
                df = df.reset_index()
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_FRED_Resident_Population_by_County_Thousands_of_Persons_BACKUP')
                c.execute('''sp_rename 'dbo.STG_FRED_Resident_Population_by_County_Thousands_of_Persons','STG_FRED_Resident_Population_by_County_Thousands_of_Persons_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_FRED_Resident_Population_by_County_Thousands_of_Persons](
                    [Series ID] [varchar](14) NULL,
                    [Region Name] [varchar](23) NULL,
                    [Region Code] [int] NULL,
                    [1975] [float] NULL,
                    [1976] [float] NULL,
                    [1977] [float] NULL,
                    [1978] [float] NULL,
                    [1979] [float] NULL,
                    [1980] [float] NULL,
                    [1981] [float] NULL,
                    [1982] [float] NULL,
                    [1983] [float] NULL,
                    [1984] [float] NULL,
                    [1985] [float] NULL,
                    [1986] [float] NULL,
                    [1987] [float] NULL,
                    [1988] [float] NULL,
                    [1989] [float] NULL,
                    [1990] [float] NULL,
                    [1991] [float] NULL,
                    [1992] [float] NULL,
                    [1993] [float] NULL,
                    [1994] [float] NULL,
                    [1995] [float] NULL,
                    [1996] [float] NULL,
                    [1997] [float] NULL,
                    [1998] [float] NULL,
                    [1999] [float] NULL,
                    [2000] [float] NULL,
                    [2001] [float] NULL,
                    [2002] [float] NULL,
                    [2003] [float] NULL,
                    [2004] [float] NULL,
                    [2005] [float] NULL,
                    [2006] [float] NULL,
                    [2007] [float] NULL,
                    [2008] [float] NULL,
                    [2009] [float] NULL,
                    [2010] [float] NULL,
                    [2011] [float] NULL,
                    [2012] [float] NULL,
                    [2013] [float] NULL,
                    [2014] [float] NULL,
                    [2015] [float] NULL,
                    [2016] [float] NULL,
                    [2017] [float] NULL,
                    [2018] [float] NULL,
                    [2019] [float] NULL,
                    [2020] [float] NULL,
                    [2021] [float] NULL,
                    [2022] [float] NULL,
                    [2023] [float] NULL,
                    [2024] [float] NULL,
                    [2025] [float] NULL,
                    [2026] [float] NULL,
                    [2027] [float] NULL,
                    [2028] [float] NULL,
                    [2029] [float] NULL,
                    [2030] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};' 
                                                    r'Server=TITANIUM-BOOK;'
                                                    r'Database=DataDashboard;'
                                                    r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_FRED_Resident_Population_by_County_Thousands_of_Persons', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            else:
                print('Please enter a number from the menu.')
                pass
        elif source == 2: #Earnings
            print('Publishing Earnings')
            table = int(input('What table are you publishing? '))
            pass
        elif source == 3: #Health
            print('Publishing Health')
            table = int(input('What table are you publishing? '))
            pass
        elif source == 4: #Labor
            print('Publishing Labor')
            table = int(input('What table are you publishing? '))
            pass
        elif source == 5: #Land
            print('Publishing Land\n-------------------------\nZillow Sources:\n1-Median Sale Price\n2-Median Value Per Sqft\n3-Zhvi\n\nGeoFred Sources:\n10-All Transactions House Price Index\n11-Homeownership Rate\n12-New Private Housing\n\n999-Exit\n-------------------------\n')
            table = int(input('What table are you publishing? '))
            if table == 1:
                print('Publishing Median Sale Price')
                df = pd.read_csv('./Updates/STG_ZLLW_County_MedianSalePrice_AllHomes.txt')
                df = df.reset_index()
                df['Metro'] = df['Metro'].replace(np.nan,'', regex=True)
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_ZLLW_County_MedianSalePrice_AllHomes_BACKUP')
                c.execute('''sp_rename 'dbo.STG_ZLLW_County_MedianSalePrice_AllHomes','STG_ZLLW_County_MedianSalePrice_AllHomes_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_ZLLW_County_MedianSalePrice_AllHomes](
                    [RegionName] [varchar](19) NULL,
                    [RegionID] [smallint] NULL,
                    [State] [varchar](2) NULL,
                    [Metro] [varchar](38) NULL,
                    [StateCodeFIPS] [varchar](2) NULL,
                    [MunicipalCodeFIPS] [varchar](3) NULL,
                    [SizeRank] [smallint] NULL,
                    [1996-04] [float] NULL,
                    [1996-05] [float] NULL,
                    [1996-06] [float] NULL,
                    [1996-07] [float] NULL,
                    [1996-08] [float] NULL,
                    [1996-09] [float] NULL,
                    [1996-10] [float] NULL,
                    [1996-11] [float] NULL,
                    [1996-12] [float] NULL,
                    [1997-01] [float] NULL,
                    [1997-02] [float] NULL,
                    [1997-03] [float] NULL,
                    [1997-04] [float] NULL,
                    [1997-05] [float] NULL,
                    [1997-06] [float] NULL,
                    [1997-07] [float] NULL,
                    [1997-08] [float] NULL,
                    [1997-09] [float] NULL,
                    [1997-10] [float] NULL,
                    [1997-11] [float] NULL,
                    [1997-12] [float] NULL,
                    [1998-01] [float] NULL,
                    [1998-02] [float] NULL,
                    [1998-03] [float] NULL,
                    [1998-04] [float] NULL,
                    [1998-05] [float] NULL,
                    [1998-06] [float] NULL,
                    [1998-07] [float] NULL,
                    [1998-08] [float] NULL,
                    [1998-09] [float] NULL,
                    [1998-10] [float] NULL,
                    [1998-11] [float] NULL,
                    [1998-12] [float] NULL,
                    [1999-01] [float] NULL,
                    [1999-02] [float] NULL,
                    [1999-03] [float] NULL,
                    [1999-04] [float] NULL,
                    [1999-05] [float] NULL,
                    [1999-06] [float] NULL,
                    [1999-07] [float] NULL,
                    [1999-08] [float] NULL,
                    [1999-09] [float] NULL,
                    [1999-10] [float] NULL,
                    [1999-11] [float] NULL,
                    [1999-12] [float] NULL,
                    [2000-01] [float] NULL,
                    [2000-02] [float] NULL,
                    [2000-03] [float] NULL,
                    [2000-04] [float] NULL,
                    [2000-05] [float] NULL,
                    [2000-06] [float] NULL,
                    [2000-07] [float] NULL,
                    [2000-08] [float] NULL,
                    [2000-09] [float] NULL,
                    [2000-10] [float] NULL,
                    [2000-11] [float] NULL,
                    [2000-12] [float] NULL,
                    [2001-01] [float] NULL,
                    [2001-02] [float] NULL,
                    [2001-03] [float] NULL,
                    [2001-04] [float] NULL,
                    [2001-05] [float] NULL,
                    [2001-06] [float] NULL,
                    [2001-07] [float] NULL,
                    [2001-08] [float] NULL,
                    [2001-09] [float] NULL,
                    [2001-10] [float] NULL,
                    [2001-11] [float] NULL,
                    [2001-12] [float] NULL,
                    [2002-01] [float] NULL,
                    [2002-02] [float] NULL,
                    [2002-03] [float] NULL,
                    [2002-04] [float] NULL,
                    [2002-05] [float] NULL,
                    [2002-06] [float] NULL,
                    [2002-07] [float] NULL,
                    [2002-08] [float] NULL,
                    [2002-09] [float] NULL,
                    [2002-10] [float] NULL,
                    [2002-11] [float] NULL,
                    [2002-12] [float] NULL,
                    [2003-01] [float] NULL,
                    [2003-02] [float] NULL,
                    [2003-03] [float] NULL,
                    [2003-04] [float] NULL,
                    [2003-05] [float] NULL,
                    [2003-06] [float] NULL,
                    [2003-07] [float] NULL,
                    [2003-08] [float] NULL,
                    [2003-09] [float] NULL,
                    [2003-10] [float] NULL,
                    [2003-11] [float] NULL,
                    [2003-12] [float] NULL,
                    [2004-01] [float] NULL,
                    [2004-02] [float] NULL,
                    [2004-03] [float] NULL,
                    [2004-04] [float] NULL,
                    [2004-05] [float] NULL,
                    [2004-06] [float] NULL,
                    [2004-07] [float] NULL,
                    [2004-08] [float] NULL,
                    [2004-09] [float] NULL,
                    [2004-10] [float] NULL,
                    [2004-11] [float] NULL,
                    [2004-12] [float] NULL,
                    [2005-01] [float] NULL,
                    [2005-02] [float] NULL,
                    [2005-03] [float] NULL,
                    [2005-04] [float] NULL,
                    [2005-05] [float] NULL,
                    [2005-06] [float] NULL,
                    [2005-07] [float] NULL,
                    [2005-08] [float] NULL,
                    [2005-09] [float] NULL,
                    [2005-10] [float] NULL,
                    [2005-11] [float] NULL,
                    [2005-12] [float] NULL,
                    [2006-01] [float] NULL,
                    [2006-02] [float] NULL,
                    [2006-03] [float] NULL,
                    [2006-04] [float] NULL,
                    [2006-05] [float] NULL,
                    [2006-06] [float] NULL,
                    [2006-07] [float] NULL,
                    [2006-08] [float] NULL,
                    [2006-09] [float] NULL,
                    [2006-10] [float] NULL,
                    [2006-11] [float] NULL,
                    [2006-12] [float] NULL,
                    [2007-01] [float] NULL,
                    [2007-02] [float] NULL,
                    [2007-03] [float] NULL,
                    [2007-04] [float] NULL,
                    [2007-05] [float] NULL,
                    [2007-06] [float] NULL,
                    [2007-07] [float] NULL,
                    [2007-08] [float] NULL,
                    [2007-09] [float] NULL,
                    [2007-10] [float] NULL,
                    [2007-11] [float] NULL,
                    [2007-12] [float] NULL,
                    [2008-01] [float] NULL,
                    [2008-02] [float] NULL,
                    [2008-03] [float] NULL,
                    [2008-04] [float] NULL,
                    [2008-05] [float] NULL,
                    [2008-06] [float] NULL,
                    [2008-07] [float] NULL,
                    [2008-08] [float] NULL,
                    [2008-09] [float] NULL,
                    [2008-10] [float] NULL,
                    [2008-11] [float] NULL,
                    [2008-12] [float] NULL,
                    [2009-01] [float] NULL,
                    [2009-02] [float] NULL,
                    [2009-03] [float] NULL,
                    [2009-04] [float] NULL,
                    [2009-05] [float] NULL,
                    [2009-06] [float] NULL,
                    [2009-07] [float] NULL,
                    [2009-08] [float] NULL,
                    [2009-09] [float] NULL,
                    [2009-10] [float] NULL,
                    [2009-11] [float] NULL,
                    [2009-12] [float] NULL,
                    [2010-01] [float] NULL,
                    [2010-02] [float] NULL,
                    [2010-03] [float] NULL,
                    [2010-04] [float] NULL,
                    [2010-05] [float] NULL,
                    [2010-06] [float] NULL,
                    [2010-07] [float] NULL,
                    [2010-08] [float] NULL,
                    [2010-09] [float] NULL,
                    [2010-10] [float] NULL,
                    [2010-11] [float] NULL,
                    [2010-12] [float] NULL,
                    [2011-01] [float] NULL,
                    [2011-02] [float] NULL,
                    [2011-03] [float] NULL,
                    [2011-04] [float] NULL,
                    [2011-05] [float] NULL,
                    [2011-06] [float] NULL,
                    [2011-07] [float] NULL,
                    [2011-08] [float] NULL,
                    [2011-09] [float] NULL,
                    [2011-10] [float] NULL,
                    [2011-11] [float] NULL,
                    [2011-12] [float] NULL,
                    [2012-01] [float] NULL,
                    [2012-02] [float] NULL,
                    [2012-03] [float] NULL,
                    [2012-04] [float] NULL,
                    [2012-05] [float] NULL,
                    [2012-06] [float] NULL,
                    [2012-07] [float] NULL,
                    [2012-08] [float] NULL,
                    [2012-09] [float] NULL,
                    [2012-10] [float] NULL,
                    [2012-11] [float] NULL,
                    [2012-12] [float] NULL,
                    [2013-01] [float] NULL,
                    [2013-02] [float] NULL,
                    [2013-03] [float] NULL,
                    [2013-04] [float] NULL,
                    [2013-05] [float] NULL,
                    [2013-06] [float] NULL,
                    [2013-07] [float] NULL,
                    [2013-08] [float] NULL,
                    [2013-09] [float] NULL,
                    [2013-10] [float] NULL,
                    [2013-11] [float] NULL,
                    [2013-12] [float] NULL,
                    [2014-01] [float] NULL,
                    [2014-02] [float] NULL,
                    [2014-03] [float] NULL,
                    [2014-04] [float] NULL,
                    [2014-05] [float] NULL,
                    [2014-06] [float] NULL,
                    [2014-07] [float] NULL,
                    [2014-08] [float] NULL,
                    [2014-09] [float] NULL,
                    [2014-10] [float] NULL,
                    [2014-11] [float] NULL,
                    [2014-12] [float] NULL,
                    [2015-01] [float] NULL,
                    [2015-02] [float] NULL,
                    [2015-03] [float] NULL,
                    [2015-04] [float] NULL,
                    [2015-05] [float] NULL,
                    [2015-06] [float] NULL,
                    [2015-07] [float] NULL,
                    [2015-08] [float] NULL,
                    [2015-09] [float] NULL,
                    [2015-10] [float] NULL,
                    [2015-11] [float] NULL,
                    [2015-12] [float] NULL,
                    [2016-01] [float] NULL,
                    [2016-02] [float] NULL,
                    [2016-03] [float] NULL,
                    [2016-04] [float] NULL,
                    [2016-05] [float] NULL,
                    [2016-06] [float] NULL,
                    [2016-07] [float] NULL,
                    [2016-08] [float] NULL,
                    [2016-09] [float] NULL,
                    [2016-10] [float] NULL,
                    [2016-11] [float] NULL,
                    [2016-12] [float] NULL,
                    [2017-01] [float] NULL,
                    [2017-02] [float] NULL,
                    [2017-03] [float] NULL,
                    [2017-04] [float] NULL,
                    [2017-05] [float] NULL,
                    [2017-06] [float] NULL,
                    [2017-07] [float] NULL,
                    [2017-08] [float] NULL,
                    [2017-09] [float] NULL,
                    [2017-10] [float] NULL,
                    [2017-11] [float] NULL,
                    [2017-12] [float] NULL,
                    [2018-01] [float] NULL,
                    [2018-02] [float] NULL,
                    [2018-03] [float] NULL,
                    [2018-04] [float] NULL,
                    [2018-05] [float] NULL,
                    [2018-06] [float] NULL,
                    [2018-07] [float] NULL,
                    [2018-08] [float] NULL,
                    [2018-09] [float] NULL,
                    [2018-10] [float] NULL,
                    [2018-11] [float] NULL,
                    [2018-12] [float] NULL,
                    [2019-01] [float] NULL,
                    [2019-02] [float] NULL,
                    [2019-03] [float] NULL,
                    [2019-04] [float] NULL,
                    [2019-05] [float] NULL,
                    [2019-06] [float] NULL,
                    [2019-07] [float] NULL,
                    [2019-08] [float] NULL,
                    [2019-09] [float] NULL,
                    [2019-10] [float] NULL,
                    [2019-11] [float] NULL,
                    [2019-12] [float] NULL,
                    [2020-01] [float] NULL,
                    [2020-02] [float] NULL,
                    [2020-03] [float] NULL,
                    [2020-04] [float] NULL,
                    [2020-05] [float] NULL,
                    [2020-06] [float] NULL,
                    [2020-07] [float] NULL,
                    [2020-08] [float] NULL,
                    [2020-09] [float] NULL,
                    [2020-10] [float] NULL,
                    [2020-11] [float] NULL,
                    [2020-12] [float] NULL,
                    [2021-01] [float] NULL,
                    [2021-02] [float] NULL,
                    [2021-03] [float] NULL,
                    [2021-04] [float] NULL,
                    [2021-05] [float] NULL,
                    [2021-06] [float] NULL,
                    [2021-07] [float] NULL,
                    [2021-08] [float] NULL,
                    [2021-09] [float] NULL,
                    [2021-10] [float] NULL,
                    [2021-11] [float] NULL,
                    [2021-12] [float] NULL,
                    [2022-01] [float] NULL,
                    [2022-02] [float] NULL,
                    [2022-03] [float] NULL,
                    [2022-04] [float] NULL,
                    [2022-05] [float] NULL,
                    [2022-06] [float] NULL,
                    [2022-07] [float] NULL,
                    [2022-08] [float] NULL,
                    [2022-09] [float] NULL,
                    [2022-10] [float] NULL,
                    [2022-11] [float] NULL,
                    [2022-12] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};'
                                                r'Server=TITANIUM-BOOK;'
                                                r'Database=DataDashboard;'
                                                r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_ZLLW_County_MedianSalePrice_AllHomes', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif source == 2:
                print('Publishing Median Value Per Sqft')
                df = pd.read_csv('./Updates/STG_ZLLW_County_MedianValuePerSqft_AllHomes.txt')
                df['Metro'] = df['Metro'].replace(np.nan,'', regex=True)
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_ZLLW_County_MedianValuePerSqft_AllHomes_BACKUP')
                c.execute('''sp_rename 'dbo.STG_ZLLW_County_MedianValuePerSqft_AllHomes','STG_ZLLW_County_MedianValuePerSqft_AllHomes_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_ZLLW_County_MedianValuePerSqft_AllHomes](
                    [RegionName] [varchar](19) NULL,
                    [RegionID] [smallint] NULL,
                    [State] [varchar](2) NULL,
                    [Metro] [varchar](38) NULL,
                    [StateCodeFIPS] [varchar](2) NULL,
                    [MunicipalCodeFIPS] [varchar](3) NULL,
                    [SizeRank] [smallint] NULL,
                    [1996-04] [float] NULL,
                    [1996-05] [float] NULL,
                    [1996-06] [float] NULL,
                    [1996-07] [float] NULL,
                    [1996-08] [float] NULL,
                    [1996-09] [float] NULL,
                    [1996-10] [float] NULL,
                    [1996-11] [float] NULL,
                    [1996-12] [float] NULL,
                    [1997-01] [float] NULL,
                    [1997-02] [float] NULL,
                    [1997-03] [float] NULL,
                    [1997-04] [float] NULL,
                    [1997-05] [float] NULL,
                    [1997-06] [float] NULL,
                    [1997-07] [float] NULL,
                    [1997-08] [float] NULL,
                    [1997-09] [float] NULL,
                    [1997-10] [float] NULL,
                    [1997-11] [float] NULL,
                    [1997-12] [float] NULL,
                    [1998-01] [float] NULL,
                    [1998-02] [float] NULL,
                    [1998-03] [float] NULL,
                    [1998-04] [float] NULL,
                    [1998-05] [float] NULL,
                    [1998-06] [float] NULL,
                    [1998-07] [float] NULL,
                    [1998-08] [float] NULL,
                    [1998-09] [float] NULL,
                    [1998-10] [float] NULL,
                    [1998-11] [float] NULL,
                    [1998-12] [float] NULL,
                    [1999-01] [float] NULL,
                    [1999-02] [float] NULL,
                    [1999-03] [float] NULL,
                    [1999-04] [float] NULL,
                    [1999-05] [float] NULL,
                    [1999-06] [float] NULL,
                    [1999-07] [float] NULL,
                    [1999-08] [float] NULL,
                    [1999-09] [float] NULL,
                    [1999-10] [float] NULL,
                    [1999-11] [float] NULL,
                    [1999-12] [float] NULL,
                    [2000-01] [float] NULL,
                    [2000-02] [float] NULL,
                    [2000-03] [float] NULL,
                    [2000-04] [float] NULL,
                    [2000-05] [float] NULL,
                    [2000-06] [float] NULL,
                    [2000-07] [float] NULL,
                    [2000-08] [float] NULL,
                    [2000-09] [float] NULL,
                    [2000-10] [float] NULL,
                    [2000-11] [float] NULL,
                    [2000-12] [float] NULL,
                    [2001-01] [float] NULL,
                    [2001-02] [float] NULL,
                    [2001-03] [float] NULL,
                    [2001-04] [float] NULL,
                    [2001-05] [float] NULL,
                    [2001-06] [float] NULL,
                    [2001-07] [float] NULL,
                    [2001-08] [float] NULL,
                    [2001-09] [float] NULL,
                    [2001-10] [float] NULL,
                    [2001-11] [float] NULL,
                    [2001-12] [float] NULL,
                    [2002-01] [float] NULL,
                    [2002-02] [float] NULL,
                    [2002-03] [float] NULL,
                    [2002-04] [float] NULL,
                    [2002-05] [float] NULL,
                    [2002-06] [float] NULL,
                    [2002-07] [float] NULL,
                    [2002-08] [float] NULL,
                    [2002-09] [float] NULL,
                    [2002-10] [float] NULL,
                    [2002-11] [float] NULL,
                    [2002-12] [float] NULL,
                    [2003-01] [float] NULL,
                    [2003-02] [float] NULL,
                    [2003-03] [float] NULL,
                    [2003-04] [float] NULL,
                    [2003-05] [float] NULL,
                    [2003-06] [float] NULL,
                    [2003-07] [float] NULL,
                    [2003-08] [float] NULL,
                    [2003-09] [float] NULL,
                    [2003-10] [float] NULL,
                    [2003-11] [float] NULL,
                    [2003-12] [float] NULL,
                    [2004-01] [float] NULL,
                    [2004-02] [float] NULL,
                    [2004-03] [float] NULL,
                    [2004-04] [float] NULL,
                    [2004-05] [float] NULL,
                    [2004-06] [float] NULL,
                    [2004-07] [float] NULL,
                    [2004-08] [float] NULL,
                    [2004-09] [float] NULL,
                    [2004-10] [float] NULL,
                    [2004-11] [float] NULL,
                    [2004-12] [float] NULL,
                    [2005-01] [float] NULL,
                    [2005-02] [float] NULL,
                    [2005-03] [float] NULL,
                    [2005-04] [float] NULL,
                    [2005-05] [float] NULL,
                    [2005-06] [float] NULL,
                    [2005-07] [float] NULL,
                    [2005-08] [float] NULL,
                    [2005-09] [float] NULL,
                    [2005-10] [float] NULL,
                    [2005-11] [float] NULL,
                    [2005-12] [float] NULL,
                    [2006-01] [float] NULL,
                    [2006-02] [float] NULL,
                    [2006-03] [float] NULL,
                    [2006-04] [float] NULL,
                    [2006-05] [float] NULL,
                    [2006-06] [float] NULL,
                    [2006-07] [float] NULL,
                    [2006-08] [float] NULL,
                    [2006-09] [float] NULL,
                    [2006-10] [float] NULL,
                    [2006-11] [float] NULL,
                    [2006-12] [float] NULL,
                    [2007-01] [float] NULL,
                    [2007-02] [float] NULL,
                    [2007-03] [float] NULL,
                    [2007-04] [float] NULL,
                    [2007-05] [float] NULL,
                    [2007-06] [float] NULL,
                    [2007-07] [float] NULL,
                    [2007-08] [float] NULL,
                    [2007-09] [float] NULL,
                    [2007-10] [float] NULL,
                    [2007-11] [float] NULL,
                    [2007-12] [float] NULL,
                    [2008-01] [float] NULL,
                    [2008-02] [float] NULL,
                    [2008-03] [float] NULL,
                    [2008-04] [float] NULL,
                    [2008-05] [float] NULL,
                    [2008-06] [float] NULL,
                    [2008-07] [float] NULL,
                    [2008-08] [float] NULL,
                    [2008-09] [float] NULL,
                    [2008-10] [float] NULL,
                    [2008-11] [float] NULL,
                    [2008-12] [float] NULL,
                    [2009-01] [float] NULL,
                    [2009-02] [float] NULL,
                    [2009-03] [float] NULL,
                    [2009-04] [float] NULL,
                    [2009-05] [float] NULL,
                    [2009-06] [float] NULL,
                    [2009-07] [float] NULL,
                    [2009-08] [float] NULL,
                    [2009-09] [float] NULL,
                    [2009-10] [float] NULL,
                    [2009-11] [float] NULL,
                    [2009-12] [float] NULL,
                    [2010-01] [float] NULL,
                    [2010-02] [float] NULL,
                    [2010-03] [float] NULL,
                    [2010-04] [float] NULL,
                    [2010-05] [float] NULL,
                    [2010-06] [float] NULL,
                    [2010-07] [float] NULL,
                    [2010-08] [float] NULL,
                    [2010-09] [float] NULL,
                    [2010-10] [float] NULL,
                    [2010-11] [float] NULL,
                    [2010-12] [float] NULL,
                    [2011-01] [float] NULL,
                    [2011-02] [float] NULL,
                    [2011-03] [float] NULL,
                    [2011-04] [float] NULL,
                    [2011-05] [float] NULL,
                    [2011-06] [float] NULL,
                    [2011-07] [float] NULL,
                    [2011-08] [float] NULL,
                    [2011-09] [float] NULL,
                    [2011-10] [float] NULL,
                    [2011-11] [float] NULL,
                    [2011-12] [float] NULL,
                    [2012-01] [float] NULL,
                    [2012-02] [float] NULL,
                    [2012-03] [float] NULL,
                    [2012-04] [float] NULL,
                    [2012-05] [float] NULL,
                    [2012-06] [float] NULL,
                    [2012-07] [float] NULL,
                    [2012-08] [float] NULL,
                    [2012-09] [float] NULL,
                    [2012-10] [float] NULL,
                    [2012-11] [float] NULL,
                    [2012-12] [float] NULL,
                    [2013-01] [float] NULL,
                    [2013-02] [float] NULL,
                    [2013-03] [float] NULL,
                    [2013-04] [float] NULL,
                    [2013-05] [float] NULL,
                    [2013-06] [float] NULL,
                    [2013-07] [float] NULL,
                    [2013-08] [float] NULL,
                    [2013-09] [float] NULL,
                    [2013-10] [float] NULL,
                    [2013-11] [float] NULL,
                    [2013-12] [float] NULL,
                    [2014-01] [float] NULL,
                    [2014-02] [float] NULL,
                    [2014-03] [float] NULL,
                    [2014-04] [float] NULL,
                    [2014-05] [float] NULL,
                    [2014-06] [float] NULL,
                    [2014-07] [float] NULL,
                    [2014-08] [float] NULL,
                    [2014-09] [float] NULL,
                    [2014-10] [float] NULL,
                    [2014-11] [float] NULL,
                    [2014-12] [float] NULL,
                    [2015-01] [float] NULL,
                    [2015-02] [float] NULL,
                    [2015-03] [float] NULL,
                    [2015-04] [float] NULL,
                    [2015-05] [float] NULL,
                    [2015-06] [float] NULL,
                    [2015-07] [float] NULL,
                    [2015-08] [float] NULL,
                    [2015-09] [float] NULL,
                    [2015-10] [float] NULL,
                    [2015-11] [float] NULL,
                    [2015-12] [float] NULL,
                    [2016-01] [float] NULL,
                    [2016-02] [float] NULL,
                    [2016-03] [float] NULL,
                    [2016-04] [float] NULL,
                    [2016-05] [float] NULL,
                    [2016-06] [float] NULL,
                    [2016-07] [float] NULL,
                    [2016-08] [float] NULL,
                    [2016-09] [float] NULL,
                    [2016-10] [float] NULL,
                    [2016-11] [float] NULL,
                    [2016-12] [float] NULL,
                    [2017-01] [float] NULL,
                    [2017-02] [float] NULL,
                    [2017-03] [float] NULL,
                    [2017-04] [float] NULL,
                    [2017-05] [float] NULL,
                    [2017-06] [float] NULL,
                    [2017-07] [float] NULL,
                    [2017-08] [float] NULL,
                    [2017-09] [float] NULL,
                    [2017-10] [float] NULL,
                    [2017-11] [float] NULL,
                    [2017-12] [float] NULL,
                    [2018-01] [float] NULL,
                    [2018-02] [float] NULL,
                    [2018-03] [float] NULL,
                    [2018-04] [float] NULL,
                    [2018-05] [float] NULL,
                    [2018-06] [float] NULL,
                    [2018-07] [float] NULL,
                    [2018-08] [float] NULL,
                    [2018-09] [float] NULL,
                    [2018-10] [float] NULL,
                    [2018-11] [float] NULL,
                    [2018-12] [float] NULL,
                    [2019-01] [float] NULL,
                    [2019-02] [float] NULL,
                    [2019-03] [float] NULL,
                    [2019-04] [float] NULL,
                    [2019-05] [float] NULL,
                    [2019-06] [float] NULL,
                    [2019-07] [float] NULL,
                    [2019-08] [float] NULL,
                    [2019-09] [float] NULL,
                    [2019-10] [float] NULL,
                    [2019-11] [float] NULL,
                    [2019-12] [float] NULL,
                    [2020-01] [float] NULL,
                    [2020-02] [float] NULL,
                    [2020-03] [float] NULL,
                    [2020-04] [float] NULL,
                    [2020-05] [float] NULL,
                    [2020-06] [float] NULL,
                    [2020-07] [float] NULL,
                    [2020-08] [float] NULL,
                    [2020-09] [float] NULL,
                    [2020-10] [float] NULL,
                    [2020-11] [float] NULL,
                    [2020-12] [float] NULL,
                    [2021-01] [float] NULL,
                    [2021-02] [float] NULL,
                    [2021-03] [float] NULL,
                    [2021-04] [float] NULL,
                    [2021-05] [float] NULL,
                    [2021-06] [float] NULL,
                    [2021-07] [float] NULL,
                    [2021-08] [float] NULL,
                    [2021-09] [float] NULL,
                    [2021-10] [float] NULL,
                    [2021-11] [float] NULL,
                    [2021-12] [float] NULL,
                    [2022-01] [float] NULL,
                    [2022-02] [float] NULL,
                    [2022-03] [float] NULL,
                    [2022-04] [float] NULL,
                    [2022-05] [float] NULL,
                    [2022-06] [float] NULL,
                    [2022-07] [float] NULL,
                    [2022-08] [float] NULL,
                    [2022-09] [float] NULL,
                    [2022-10] [float] NULL,
                    [2022-11] [float] NULL,
                    [2022-12] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};'
                                                r'Server=TITANIUM-BOOK;'
                                                r'Database=DataDashboard;'
                                                r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_ZLLW_County_MedianValuePerSqft_AllHomes', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif source == 3: 
                print('Publishing Zhvi')
                df = pd.read_csv('./Updates/STG_ZLLW_County_Zhvi_AllHomes.txt')
                df['Metro'] = df['Metro'].replace(np.nan,'', regex=True)
                column_list = df.columns.values
                for i in column_list:
                    df.loc[df[i].isnull(),i]=0
                c.execute('drop table STG_ZLLW_County_Zhvi_AllHomes_BACKUP')
                c.execute('''sp_rename 'dbo.STG_ZLLW_County_Zhvi_AllHomes','STG_ZLLW_County_Zhvi_AllHomes_BACKUP';''')
                c.execute('''USE [DataDashboard]
                SET ANSI_NULLS ON
                SET QUOTED_IDENTIFIER ON
                CREATE TABLE [dbo].[STG_ZLLW_County_Zhvi_AllHomes](
                    [RegionName] [varchar](19) NULL,
                    [RegionID] [smallint] NULL,
                    [State] [varchar](2) NULL,
                    [Metro] [varchar](38) NULL,
                    [StateCodeFIPS] [varchar](2) NULL,
                    [MunicipalCodeFIPS] [varchar](3) NULL,
                    [SizeRank] [smallint] NULL,
                    [1996-04] [float] NULL,
                    [1996-05] [float] NULL,
                    [1996-06] [float] NULL,
                    [1996-07] [float] NULL,
                    [1996-08] [float] NULL,
                    [1996-09] [float] NULL,
                    [1996-10] [float] NULL,
                    [1996-11] [float] NULL,
                    [1996-12] [float] NULL,
                    [1997-01] [float] NULL,
                    [1997-02] [float] NULL,
                    [1997-03] [float] NULL,
                    [1997-04] [float] NULL,
                    [1997-05] [float] NULL,
                    [1997-06] [float] NULL,
                    [1997-07] [float] NULL,
                    [1997-08] [float] NULL,
                    [1997-09] [float] NULL,
                    [1997-10] [float] NULL,
                    [1997-11] [float] NULL,
                    [1997-12] [float] NULL,
                    [1998-01] [float] NULL,
                    [1998-02] [float] NULL,
                    [1998-03] [float] NULL,
                    [1998-04] [float] NULL,
                    [1998-05] [float] NULL,
                    [1998-06] [float] NULL,
                    [1998-07] [float] NULL,
                    [1998-08] [float] NULL,
                    [1998-09] [float] NULL,
                    [1998-10] [float] NULL,
                    [1998-11] [float] NULL,
                    [1998-12] [float] NULL,
                    [1999-01] [float] NULL,
                    [1999-02] [float] NULL,
                    [1999-03] [float] NULL,
                    [1999-04] [float] NULL,
                    [1999-05] [float] NULL,
                    [1999-06] [float] NULL,
                    [1999-07] [float] NULL,
                    [1999-08] [float] NULL,
                    [1999-09] [float] NULL,
                    [1999-10] [float] NULL,
                    [1999-11] [float] NULL,
                    [1999-12] [float] NULL,
                    [2000-01] [float] NULL,
                    [2000-02] [float] NULL,
                    [2000-03] [float] NULL,
                    [2000-04] [float] NULL,
                    [2000-05] [float] NULL,
                    [2000-06] [float] NULL,
                    [2000-07] [float] NULL,
                    [2000-08] [float] NULL,
                    [2000-09] [float] NULL,
                    [2000-10] [float] NULL,
                    [2000-11] [float] NULL,
                    [2000-12] [float] NULL,
                    [2001-01] [float] NULL,
                    [2001-02] [float] NULL,
                    [2001-03] [float] NULL,
                    [2001-04] [float] NULL,
                    [2001-05] [float] NULL,
                    [2001-06] [float] NULL,
                    [2001-07] [float] NULL,
                    [2001-08] [float] NULL,
                    [2001-09] [float] NULL,
                    [2001-10] [float] NULL,
                    [2001-11] [float] NULL,
                    [2001-12] [float] NULL,
                    [2002-01] [float] NULL,
                    [2002-02] [float] NULL,
                    [2002-03] [float] NULL,
                    [2002-04] [float] NULL,
                    [2002-05] [float] NULL,
                    [2002-06] [float] NULL,
                    [2002-07] [float] NULL,
                    [2002-08] [float] NULL,
                    [2002-09] [float] NULL,
                    [2002-10] [float] NULL,
                    [2002-11] [float] NULL,
                    [2002-12] [float] NULL,
                    [2003-01] [float] NULL,
                    [2003-02] [float] NULL,
                    [2003-03] [float] NULL,
                    [2003-04] [float] NULL,
                    [2003-05] [float] NULL,
                    [2003-06] [float] NULL,
                    [2003-07] [float] NULL,
                    [2003-08] [float] NULL,
                    [2003-09] [float] NULL,
                    [2003-10] [float] NULL,
                    [2003-11] [float] NULL,
                    [2003-12] [float] NULL,
                    [2004-01] [float] NULL,
                    [2004-02] [float] NULL,
                    [2004-03] [float] NULL,
                    [2004-04] [float] NULL,
                    [2004-05] [float] NULL,
                    [2004-06] [float] NULL,
                    [2004-07] [float] NULL,
                    [2004-08] [float] NULL,
                    [2004-09] [float] NULL,
                    [2004-10] [float] NULL,
                    [2004-11] [float] NULL,
                    [2004-12] [float] NULL,
                    [2005-01] [float] NULL,
                    [2005-02] [float] NULL,
                    [2005-03] [float] NULL,
                    [2005-04] [float] NULL,
                    [2005-05] [float] NULL,
                    [2005-06] [float] NULL,
                    [2005-07] [float] NULL,
                    [2005-08] [float] NULL,
                    [2005-09] [float] NULL,
                    [2005-10] [float] NULL,
                    [2005-11] [float] NULL,
                    [2005-12] [float] NULL,
                    [2006-01] [float] NULL,
                    [2006-02] [float] NULL,
                    [2006-03] [float] NULL,
                    [2006-04] [float] NULL,
                    [2006-05] [float] NULL,
                    [2006-06] [float] NULL,
                    [2006-07] [float] NULL,
                    [2006-08] [float] NULL,
                    [2006-09] [float] NULL,
                    [2006-10] [float] NULL,
                    [2006-11] [float] NULL,
                    [2006-12] [float] NULL,
                    [2007-01] [float] NULL,
                    [2007-02] [float] NULL,
                    [2007-03] [float] NULL,
                    [2007-04] [float] NULL,
                    [2007-05] [float] NULL,
                    [2007-06] [float] NULL,
                    [2007-07] [float] NULL,
                    [2007-08] [float] NULL,
                    [2007-09] [float] NULL,
                    [2007-10] [float] NULL,
                    [2007-11] [float] NULL,
                    [2007-12] [float] NULL,
                    [2008-01] [float] NULL,
                    [2008-02] [float] NULL,
                    [2008-03] [float] NULL,
                    [2008-04] [float] NULL,
                    [2008-05] [float] NULL,
                    [2008-06] [float] NULL,
                    [2008-07] [float] NULL,
                    [2008-08] [float] NULL,
                    [2008-09] [float] NULL,
                    [2008-10] [float] NULL,
                    [2008-11] [float] NULL,
                    [2008-12] [float] NULL,
                    [2009-01] [float] NULL,
                    [2009-02] [float] NULL,
                    [2009-03] [float] NULL,
                    [2009-04] [float] NULL,
                    [2009-05] [float] NULL,
                    [2009-06] [float] NULL,
                    [2009-07] [float] NULL,
                    [2009-08] [float] NULL,
                    [2009-09] [float] NULL,
                    [2009-10] [float] NULL,
                    [2009-11] [float] NULL,
                    [2009-12] [float] NULL,
                    [2010-01] [float] NULL,
                    [2010-02] [float] NULL,
                    [2010-03] [float] NULL,
                    [2010-04] [float] NULL,
                    [2010-05] [float] NULL,
                    [2010-06] [float] NULL,
                    [2010-07] [float] NULL,
                    [2010-08] [float] NULL,
                    [2010-09] [float] NULL,
                    [2010-10] [float] NULL,
                    [2010-11] [float] NULL,
                    [2010-12] [float] NULL,
                    [2011-01] [float] NULL,
                    [2011-02] [float] NULL,
                    [2011-03] [float] NULL,
                    [2011-04] [float] NULL,
                    [2011-05] [float] NULL,
                    [2011-06] [float] NULL,
                    [2011-07] [float] NULL,
                    [2011-08] [float] NULL,
                    [2011-09] [float] NULL,
                    [2011-10] [float] NULL,
                    [2011-11] [float] NULL,
                    [2011-12] [float] NULL,
                    [2012-01] [float] NULL,
                    [2012-02] [float] NULL,
                    [2012-03] [float] NULL,
                    [2012-04] [float] NULL,
                    [2012-05] [float] NULL,
                    [2012-06] [float] NULL,
                    [2012-07] [float] NULL,
                    [2012-08] [float] NULL,
                    [2012-09] [float] NULL,
                    [2012-10] [float] NULL,
                    [2012-11] [float] NULL,
                    [2012-12] [float] NULL,
                    [2013-01] [float] NULL,
                    [2013-02] [float] NULL,
                    [2013-03] [float] NULL,
                    [2013-04] [float] NULL,
                    [2013-05] [float] NULL,
                    [2013-06] [float] NULL,
                    [2013-07] [float] NULL,
                    [2013-08] [float] NULL,
                    [2013-09] [float] NULL,
                    [2013-10] [float] NULL,
                    [2013-11] [float] NULL,
                    [2013-12] [float] NULL,
                    [2014-01] [float] NULL,
                    [2014-02] [float] NULL,
                    [2014-03] [float] NULL,
                    [2014-04] [float] NULL,
                    [2014-05] [float] NULL,
                    [2014-06] [float] NULL,
                    [2014-07] [float] NULL,
                    [2014-08] [float] NULL,
                    [2014-09] [float] NULL,
                    [2014-10] [float] NULL,
                    [2014-11] [float] NULL,
                    [2014-12] [float] NULL,
                    [2015-01] [float] NULL,
                    [2015-02] [float] NULL,
                    [2015-03] [float] NULL,
                    [2015-04] [float] NULL,
                    [2015-05] [float] NULL,
                    [2015-06] [float] NULL,
                    [2015-07] [float] NULL,
                    [2015-08] [float] NULL,
                    [2015-09] [float] NULL,
                    [2015-10] [float] NULL,
                    [2015-11] [float] NULL,
                    [2015-12] [float] NULL,
                    [2016-01] [float] NULL,
                    [2016-02] [float] NULL,
                    [2016-03] [float] NULL,
                    [2016-04] [float] NULL,
                    [2016-05] [float] NULL,
                    [2016-06] [float] NULL,
                    [2016-07] [float] NULL,
                    [2016-08] [float] NULL,
                    [2016-09] [float] NULL,
                    [2016-10] [float] NULL,
                    [2016-11] [float] NULL,
                    [2016-12] [float] NULL,
                    [2017-01] [float] NULL,
                    [2017-02] [float] NULL,
                    [2017-03] [float] NULL,
                    [2017-04] [float] NULL,
                    [2017-05] [float] NULL,
                    [2017-06] [float] NULL,
                    [2017-07] [float] NULL,
                    [2017-08] [float] NULL,
                    [2017-09] [float] NULL,
                    [2017-10] [float] NULL,
                    [2017-11] [float] NULL,
                    [2017-12] [float] NULL,
                    [2018-01] [float] NULL,
                    [2018-02] [float] NULL,
                    [2018-03] [float] NULL,
                    [2018-04] [float] NULL,
                    [2018-05] [float] NULL,
                    [2018-06] [float] NULL,
                    [2018-07] [float] NULL,
                    [2018-08] [float] NULL,
                    [2018-09] [float] NULL,
                    [2018-10] [float] NULL,
                    [2018-11] [float] NULL,
                    [2018-12] [float] NULL,
                    [2019-01] [float] NULL,
                    [2019-02] [float] NULL,
                    [2019-03] [float] NULL,
                    [2019-04] [float] NULL,
                    [2019-05] [float] NULL,
                    [2019-06] [float] NULL,
                    [2019-07] [float] NULL,
                    [2019-08] [float] NULL,
                    [2019-09] [float] NULL,
                    [2019-10] [float] NULL,
                    [2019-11] [float] NULL,
                    [2019-12] [float] NULL,
                    [2020-01] [float] NULL,
                    [2020-02] [float] NULL,
                    [2020-03] [float] NULL,
                    [2020-04] [float] NULL,
                    [2020-05] [float] NULL,
                    [2020-06] [float] NULL,
                    [2020-07] [float] NULL,
                    [2020-08] [float] NULL,
                    [2020-09] [float] NULL,
                    [2020-10] [float] NULL,
                    [2020-11] [float] NULL,
                    [2020-12] [float] NULL,
                    [2021-01] [float] NULL,
                    [2021-02] [float] NULL,
                    [2021-03] [float] NULL,
                    [2021-04] [float] NULL,
                    [2021-05] [float] NULL,
                    [2021-06] [float] NULL,
                    [2021-07] [float] NULL,
                    [2021-08] [float] NULL,
                    [2021-09] [float] NULL,
                    [2021-10] [float] NULL,
                    [2021-11] [float] NULL,
                    [2021-12] [float] NULL,
                    [2022-01] [float] NULL,
                    [2022-02] [float] NULL,
                    [2022-03] [float] NULL,
                    [2022-04] [float] NULL,
                    [2022-05] [float] NULL,
                    [2022-06] [float] NULL,
                    [2022-07] [float] NULL,
                    [2022-08] [float] NULL,
                    [2022-09] [float] NULL,
                    [2022-10] [float] NULL,
                    [2022-11] [float] NULL,
                    [2022-12] [float] NULL
                ) ON [PRIMARY]''')
                params = urllib.parse.quote_plus(r'Driver={SQL Server};' 
                                                r'Server=TITANIUM-BOOK;'
                                                r'Database=DataDashboard;'
                                                r'Trusted_Connection=yes;')
                engine = create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)
                df.to_sql('STG_ZLLW_County_Zhvi_AllHomes', con=engine, if_exists='replace', index=False)
                print('Published.')
                pass
            elif source == 999:
                exit()          
            else:
                print('Please enter a number from the menu.')
                pass  
        elif source == 6: #Natural Products
            print('Updating Natural Products')
            table = int(input('What table are you publishing? '))
            pass
        elif source == 999:
            exit()
        else:
            print('Please enter a number from the menu.')
            SQL()
    while True:
        SQL()
        endProgram()
except:
    print('this broke')